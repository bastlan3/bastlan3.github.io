<!DOCTYPE html>
<html>
<head>
    <title>Update Seal Image</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        #preview {
            max-width: 300px;
            margin: 20px;
        }
    </style>
</head>
<body>
    <h1>Update Seal Image</h1>
    
    <input type="file" id="imageInput" accept="image/*">
    <br>
    <img id="preview" src="images/sealpic.png">
    <br>
    <button onclick="uploadImage()">Save Image</button>

    <script>
        let selectedFile;

        // Preview image
        document.getElementById('imageInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            selectedFile = file;
            const reader = new FileReader();
            
            reader.onload = function(e) {
                document.getElementById('preview').src = e.target.result;
            };
            
            reader.readAsDataURL(file);
        });

        async function uploadImage() {
            if (!selectedFile) return alert('Select an image first!');

            const githubToken = prompt('Enter GitHub Personal Access Token:');
            if (!githubToken) return;

            const reader = new FileReader();
            reader.readAsDataURL(selectedFile);
            
            reader.onloadend = async function() {
                const content = reader.result.split(',')[1]; // Remove data URL prefix
                
                try {
                    const response = await fetch(
                        'https://api.github.com/repos/bastlan3/bastlan3.github.io/contents/images/sealpic.png',
                        {
                            method: 'PUT',
                            headers: {
                                'Authorization': `token ${githubToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                message: "Update seal image",
                                content: content,
                                sha: await getCurrentSha()
                            })
                        }
                    );

                    if (response.ok) {
                        alert('Image updated successfully!');
                        location.reload();
                    } else {
                        alert('Error updating image');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Upload failed');
                }
            };
        }

        async function getCurrentSha() {
            const response = await fetch(
                'https://api.github.com/repos/bastlan3/bastlan3.github.io/contents/images/sealpic.png'
            );
            const data = await response.json();
            return data.sha;
        }
    </script>
</body>
</html>
